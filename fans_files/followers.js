!function(){function e(e,o){window.WebViewJavascriptBridge&&window.WebViewJavascriptBridge.callHandler("webNotify",{notifyType:"notifyFollowUserUpdate",shopID:o,followed:e})}function o(o){function r(){n.addClass(l),setTimeout(function(){n.removeClass(l)},600)}var l="shopee_disabled",n=$(o.currentTarget),a=n.attr("shopid");n.hasClass(l)||(n.hasClass("active")?$.post("/buyer/unfollow/shop/"+a+"/",{csrfmiddlewaretoken:csrf},function(o){--d,r(),current_shop_id==a?n.toggle(!1):(n.removeClass("active").text("+ "+label_follow),e(0,a))}).fail(function(e){t(parseInt(e.responseText))}):$.post("/buyer/follow/shop/"+a+"/",{csrfmiddlewaretoken:csrf},function(o){++d,r(),n.addClass("active").text(label_following),e(1,a)}).fail(function(e){t(parseInt(e.responseText))}))}function t(e){3==e?alert_message(alert_follow_limit):15==e&&alert_message(alert_follow_too_frequent)}function r(){if(!s&&!i){var e=scrollTopFunc(),o=$(window).height(),t=$(document).height(),r=t-o-e;r<f&&l()}}function l(){i=!0,a(i);var e=parseInt($(".follower-list li:last-child").attr("data-follower-cursor"));(isNaN(e)||""==e)&&(e=0);var o={offset:e+1,limit:c,offset_of_offset:d};$.get(load_more_url+"?"+$.param(o),function(e){e.no_more?(s=!0,is_following?$(".loading-text").html(i18n.t("msg_no_more_following")):$(".loading-text").html(i18n.t("msg_no_more_followers"))):($(".follower-list").append(e),n(),a(i)),i=!1,$(".shop-href").off("tap").on("tap",function(e){e.stopPropagation(),e.preventDefault();var o=$(this),t=o.attr("href");navigate(t)})}).fail(function(){alert_message(i18n.t("msg_fail_to_load_more_followers")),i=!1,a(i)}),$(".shop-href").off("tap").on("tap",function(e){e.stopPropagation(),e.preventDefault();var o=$(this),t=o.attr("href");navigate(t)})}function n(){var e={};$(".follower-list").children().each(function(o,t){var r=$(t),l=r.attr("data-follower-shop-id");l in e?r.remove():e[l]=!0})}function a(e){var o=$(".follower-list");(o.children().length>1||0==o.find(".empty_holder").length)&&$(".loading-text").toggle(e)}iOSRemoveBottomInset();var i=!1,s=!1,f=50,c=20,d=0;$(function(){$(".shop-href").off("tap").on("tap",function(e){e.stopPropagation(),e.preventDefault();var o=$(this),t=o.attr("href");navigate(t)}),$(".follower-list").on("tap",".btn-follow",function(e){window.WebViewJavascriptBridge?window.WebViewJavascriptBridge.callHandler("login",{},function(t){1==t.status&&o(e)}):loggedin?o(e):askLogin()}),$(".follower-list").on("tap",".btn-remove",function(o){if(is_following){var t=$(o.currentTarget).attr("data-delete-id");$.post("/buyer/unfollow/shop/"+t+"/",{csrfmiddlewaretoken:csrf},function(r){--d,e(0,t),is_owner?$(o.currentTarget).parent().hide():$(o.currentTarget).hide(),alert_message(msg_deleted_following_removed)}).fail(function(e){alert_message(msg_server_error)})}else $.post("remove",{follower_id:$(o.currentTarget).attr("data-delete-id"),csrfmiddlewaretoken:csrf}).success(function(r){var l=r.success;l?(--d,e(0,t),$(o.currentTarget).parent().hide(),alert_message(msg_deleted_follower_removed)):alert_message(msg_server_error)})}),bridgeInit(function(e){setTimeout(function(){var e=window.location.href;if(e.indexOf("follower")!=-1)var o=label_follower;else if(e.indexOf("following")!=-1)var o=label_following;bridgeCallHandler("configureNavBarTitle",{title:o})},200)}),$(window).on("scroll",r)})}();
//# sourceMappingURL=../../source_maps/shop/followers.js.map
